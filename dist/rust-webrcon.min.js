(function(window){'use strict';function d(a,b,c){this.f=void 0===b?"localhost":b;this.c=void 0===c?"27018":c;this.g=a;this.b=!1;this.a=null}d.prototype.open=function(){var a=this;return new Promise(function(b,c){a.b?c("Connection already established"):(a.a=new WebSocket("ws://"+a.f+":"+a.c+"/"+a.g),a.a.onopen=function(){1===a.a.readyState&&(a.b=!0,b(a.a))},a.a.onerror=function(){return c("Error in connection establishment")})})};
d.prototype.close=function(){var a=this;return new Promise(function(b){if(a.b&&1===a.a.readyState)a.a.close(1E3),a.a.onclose=function(){a.b=!1;b(a.a)};else throw Error("Connection isn't established yet");})};d.prototype.cmd=function(a,b){b=void 0===b?-1:b;var c=this;return new Promise(function(e,f){c.send(a,b,e,f)})};d.prototype.cmdThen=function(a,b){b=void 0===b?-1:b;var c=this;return function(){return new Promise(function(e,f){c.send(a,b,e,f)})}};
d.prototype.send=function(a,b,c,e){if(!this.b)return e("Connection isn't established yet");a=JSON.stringify({Identifier:b,Message:a,Name:"WebRcon"});this.a.onerror=function(){return e("Error in connection establishment")};this.a.onmessage=function(a){return c(JSON.parse(a.data).h)};this.a.send(a)};window.RustWebRcon=d;})(window);
